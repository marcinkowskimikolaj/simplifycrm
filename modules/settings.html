<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simplify CRM ‚Äî Ustawienia</title>

  <link rel="stylesheet" href="../styles/base.css" />
  <link rel="stylesheet" href="../styles/settings.css" />
  <link rel="stylesheet" href="../styles/custom-fields.css" />
</head>
<body>

<header class="app-header">
  <div class="app-header-inner">
    <div class="logo-block" id="logoBlock" style="cursor:pointer;">
      <div class="logo">SIMPLIFY CRM</div>
      <div class="subtitle">USTAWIENIA CRM</div>
    </div>

    <div class="header-right">
      <span id="userEmail" class="user-email">...</span>
      <button id="profileBtn" class="icon-btn" title="Personalizacja konta">
        üë§
      </button>
      <button id="logoutBtn" class="logout-btn">WYLOGUJ</button>
    </div>
  </div>
</header>

<main class="settings-container">
  <div class="settings-layout">

    <aside class="settings-sidebar">
      <div class="settings-nav-title">Nawigacja</div>
      <div class="settings-nav">
        <button class="active" data-section="customFields">
          <div class="nav-item-top">
            <span class="nav-item-label">üß© Pola w≈Çasne</span>
          </div>
          <span class="nav-item-sub">Kontakty i firmy</span>
        </button>

        <button data-section="pipeline">
          <div class="nav-item-top">
            <span class="nav-item-label">üß± Pipeline</span>
            <span class="badge-soon">Wkr√≥tce</span>
          </div>
          <span class="nav-item-sub">Etapy sprzeda≈ºy</span>
        </button>

        <button data-section="ai">
          <div class="nav-item-top">
            <span class="nav-item-label">‚ú® Ustawienia AI</span>
            <span class="badge-soon">Wkr√≥tce</span>
          </div>
          <span class="nav-item-sub">Modele i klucze</span>
        </button>
      </div>
    </aside>

    <section class="settings-content">
      <!-- Custom Fields -->
      <div id="section-customFields" class="settings-section">
        <div class="section-header">
          <div>
            <div class="section-title">Pola w≈Çasne</div>
            <div class="section-desc">Zdefiniuj w≈Çasne pola dla kontakt√≥w i firm. Pola pojawiƒÖ siƒô w formularzach oraz w widoku szczeg√≥≈Ç√≥w.</div>
          </div>

          <div class="section-actions">
            <div class="tabs" role="tablist" aria-label="Filtr p√≥l w≈Çasnych">
              <button class="tab active" data-filter="company" type="button">Firmy</button>
              <button class="tab" data-filter="contact" type="button">Kontakty</button>
              <button class="tab" data-filter="both" type="button">Obie</button>
            </div>
            <button class="btn btn-primary" id="addFieldBtn" type="button">Ôºã Dodaj pole</button>
          </div>
        </div>

        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>Nazwa</th>
                <th>Klucz</th>
                <th>Typ</th>
                <th>Wymagane</th>
                <th>Aktywne</th>
                <th>Kolejno≈õƒá</th>
                <th>Akcje</th>
              </tr>
            </thead>
            <tbody id="fieldsTbody">
              <tr><td colspan="7" class="muted">≈Åadowanie‚Ä¶</td></tr>
            </tbody>
          </table>
        </div>

        <div class="notice">
          <b>Arkusze wymagane w Google Sheets:</b> <code>CustomFields</code> oraz <code>CustomFieldValues</code>.
          Je≈õli ich nie ma, utw√≥rz je i dodaj nag≈Ç√≥wki w wierszu 1 (kolumny zgodnie z dokumentacjƒÖ w kodzie).
        </div>
      </div>

      <!-- Pipeline placeholder -->
      <div id="section-pipeline" class="settings-section" style="display:none;">
        <div class="section-header">
          <div>
            <div class="section-title">Pipeline</div>
            <div class="section-desc">Tu bƒôdziesz zarzƒÖdzaƒá etapami sprzeda≈ºy oraz domy≈õlnymi ustawieniami deal'i.</div>
          </div>
        </div>
        <div class="muted">Sekcja w przygotowaniu.</div>
      </div>

      <!-- AI placeholder -->
      <div id="section-ai" class="settings-section" style="display:none;">
        <div class="section-header">
          <div>
            <div class="section-title">Ustawienia AI</div>
            <div class="section-desc">Tu dodasz modele, klucze API oraz zgodƒô na przetwarzanie danych (per u≈ºytkownik).</div>
          </div>
        </div>
        <div class="muted">Sekcja w przygotowaniu.</div>
      </div>
    </section>

  </div>
</main>

<!-- Modal: Add/Edit Custom Field -->
<div id="fieldModal" class="modal" aria-hidden="true">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="fieldModalTitle">Dodaj pole</h2>
      <button class="close-btn" id="closeFieldModalBtn" type="button">√ó</button>
    </div>

    <form id="fieldForm">
      <div class="modal-body">
        <input type="hidden" id="fieldRowIndex" />

        <div class="form-grid">
          <div class="form-group">
            <label for="fieldName">Nazwa pola *</label>
            <input id="fieldName" required placeholder="np. ≈πr√≥d≈Ço leadu" />
          </div>

          <div class="form-group">
            <label for="fieldKey">Klucz (ID) *</label>
            <input id="fieldKey" required placeholder="np. lead_source" />
          </div>

          <div class="form-group">
            <label for="fieldEntityType">Dotyczy</label>
            <select id="fieldEntityType">
              <option value="company">Firma</option>
              <option value="contact">Kontakt</option>
              <option value="both">Obie</option>
            </select>
          </div>

          <div class="form-group">
            <label for="fieldType">Typ pola</label>
            <select id="fieldType">
              <option value="text">Tekst (1 linia)</option>
              <option value="textarea">Tekst (wiele linii)</option>
              <option value="number">Liczba</option>
              <option value="date">Data</option>
              <option value="select">Lista wyboru</option>
            </select>
          </div>

          <div class="form-group">
            <label for="fieldRequired">Wymagane</label>
            <select id="fieldRequired">
              <option value="false">Nie</option>
              <option value="true">Tak</option>
            </select>
          </div>

          <div class="form-group">
            <label for="fieldEnabled">Aktywne</label>
            <select id="fieldEnabled">
              <option value="true">Tak</option>
              <option value="false">Nie</option>
            </select>
          </div>

          <div class="form-group">
            <label for="fieldOrder">Kolejno≈õƒá</label>
            <input id="fieldOrder" type="number" value="0" />
          </div>

          <div class="form-group" style="grid-column: 1 / -1;">
            <label for="fieldOptions">Opcje (tylko dla ‚ÄûLista wyboru‚Äù)</label>
            <textarea id="fieldOptions" placeholder="Jedna opcja na liniƒô&#10;np. Polecenie&#10;Reklama&#10;LinkedIn"></textarea>
            <div class="muted" style="margin-top:0.35rem;">W arkuszu zapisujemy jako JSON (tablica string√≥w).</div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn" type="button" id="cancelFieldBtn">Anuluj</button>
        <button class="btn btn-primary" type="submit">Zapisz</button>
      </div>
    </form>
  </div>
</div>

<script type="module" src="./settings.js"></script>
</body>
</html>
